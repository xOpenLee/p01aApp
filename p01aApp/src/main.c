
#include <stdio.h>
#include "platform.h"
#include "serialscreen.h"
#include "utils.h"

#define PROJ_NAME "P01A"
#define PROJ_VERSION "V0.0.1"

/*******************************************************************************
* 函数名称:PrintVer
* 描    述:  打印项目名称、版本信息、编译时间
* 输    入:无
* 输    出:无
* 返    回:void
* 修改日期:2016年6月21日
*******************************************************************************/
static void PrintVer(void)
{
	printf("#INFO: Proj Name %s %s\n", PROJ_NAME, PROJ_VERSION);
	printf("#INFO: Built Time %s %s\n", __TIME__, __DATE__);
}

#if defined(CONFIG_PROJ)
int main()
{
    init_platform();

    PrintVer();

    SerialScreenInit();

    cleanup_platform();

    return 0;
}
#else

/*
 * helloworld.c: simple test application
 *
 * This application configures UART 16550 to baud rate 9600.
 * PS7 UART (Zynq) is not initialized by this application, since
 * bootrom/bsp configures it to baud rate 115200
 *
 * ------------------------------------------------
 * | UART TYPE   BAUD RATE                        |
 * ------------------------------------------------
 *   uartns550   9600
 *   uartlite    Configurable only in HW design
 *   ps7_uart    115200 (configured by bootrom/bsp)
 */

#include <stdio.h>
#include "platform.h"

void print(char *str);

void delay_us(unsigned int us_number)
{
unsigned int i;
unsigned int j;
for(i=0;i<us_number;i++)
{

	for(j=0;j<120;j++);

}

}

void ad9518_config()
{
	Xil_Out32(0x61000000 + 0x118,0x00107c00);
	Xil_Out32(0x61000000 + 0x120,0x1);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x118,0x00130400);
	Xil_Out32(0x61000000 + 0x120,0x1);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x118,0x00140700);
	Xil_Out32(0x61000000 + 0x120,0x1);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x118,0x00160400);
	Xil_Out32(0x61000000 + 0x120,0x1);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x118,0x001c0200);
	Xil_Out32(0x61000000 + 0x120,0x1);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x118,0x00180400);
	Xil_Out32(0x61000000 + 0x120,0x1);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x118,0x02320100);
	Xil_Out32(0x61000000 + 0x120,0x1);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x118,0x01e00000);
	Xil_Out32(0x61000000 + 0x120,0x1);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x118,0x01e10200);
	Xil_Out32(0x61000000 + 0x120,0x1);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x118,0x00180500);
	Xil_Out32(0x61000000 + 0x120,0x1);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x118,0x01902200);
	Xil_Out32(0x61000000 + 0x120,0x1);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x118,0x01932200);
	Xil_Out32(0x61000000 + 0x120,0x1);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x118,0x01962200);
	Xil_Out32(0x61000000 + 0x120,0x1);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x118,0x00f00800);
	Xil_Out32(0x61000000 + 0x120,0x1);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x118,0x00f10800);
	Xil_Out32(0x61000000 + 0x120,0x1);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x118,0x00f20800);
	Xil_Out32(0x61000000 + 0x120,0x1);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x118,0x00f30800);
	Xil_Out32(0x61000000 + 0x120,0x1);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x118,0x00f40800);
	Xil_Out32(0x61000000 + 0x120,0x1);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x118,0x00f50800);
	Xil_Out32(0x61000000 + 0x120,0x1);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x118,0x01910000);
	Xil_Out32(0x61000000 + 0x120,0x1);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x118,0x01940000);
	Xil_Out32(0x61000000 + 0x120,0x1);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x118,0x01970000);
	Xil_Out32(0x61000000 + 0x120,0x1);
	delay_us(1);

	Xil_Out32(0x61000000 + 0x118,0x02320100);
	Xil_Out32(0x61000000 + 0x120,0x1);
	delay_us(1);
}

void ad9520_config()
{
	Xil_Out32(0x61000000 + 0x11c,0x00107c00);
	Xil_Out32(0x61000000 + 0x120,0x10);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x11c,0x00130400);
	Xil_Out32(0x61000000 + 0x120,0x10);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x11c,0x00140700);
	Xil_Out32(0x61000000 + 0x120,0x10);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x11c,0x00160400);
	Xil_Out32(0x61000000 + 0x120,0x10);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x11c,0x01e10200);
	Xil_Out32(0x61000000 + 0x120,0x10);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x11c,0x001c0200);
	Xil_Out32(0x61000000 + 0x120,0x10);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x11c,0x01e00000);
	Xil_Out32(0x61000000 + 0x120,0x10);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x11c,0x00180400);
	Xil_Out32(0x61000000 + 0x120,0x10);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x11c,0x02320100);
	Xil_Out32(0x61000000 + 0x120,0x10);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x11c,0x01902200);
	Xil_Out32(0x61000000 + 0x120,0x10);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x11c,0x01932200);
	Xil_Out32(0x61000000 + 0x120,0x10);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x11c,0x01962200);
	Xil_Out32(0x61000000 + 0x120,0x10);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x11c,0x01992200);
	Xil_Out32(0x61000000 + 0x120,0x10);
	delay_us(1);
	//Xil_Out32(0x61000000 + 0x11c,0x00f0fc00);
	Xil_Out32(0x61000000 + 0x11c,0x00f06400);
	Xil_Out32(0x61000000 + 0x120,0x10);
	delay_us(1);
	//Xil_Out32(0x61000000 + 0x11c,0x00f1fc00);
	Xil_Out32(0x61000000 + 0x11c,0x00f16400);
	Xil_Out32(0x61000000 + 0x120,0x10);
	delay_us(1);
	//Xil_Out32(0x61000000 + 0x11c,0x00f2fc00);
	Xil_Out32(0x61000000 + 0x11c,0x00f26400);
	Xil_Out32(0x61000000 + 0x120,0x10);
	delay_us(1);
	//Xil_Out32(0x61000000 + 0x11c,0x00f3fc00);
	Xil_Out32(0x61000000 + 0x11c,0x00f36400);
	Xil_Out32(0x61000000 + 0x120,0x10);
	delay_us(1);
	//Xil_Out32(0x61000000 + 0x11c,0x00f4fc00);
	Xil_Out32(0x61000000 + 0x11c,0x00f46400);
	Xil_Out32(0x61000000 + 0x120,0x10);
	delay_us(1);
	//Xil_Out32(0x61000000 + 0x11c,0x00f5fc00);
	Xil_Out32(0x61000000 + 0x11c,0x00f56400);
	Xil_Out32(0x61000000 + 0x120,0x10);
	delay_us(1);
	//Xil_Out32(0x61000000 + 0x11c,0x00f6fc00);
	Xil_Out32(0x61000000 + 0x11c,0x00f66400);
	Xil_Out32(0x61000000 + 0x120,0x10);
	delay_us(1);
	//Xil_Out32(0x61000000 + 0x11c,0x00f7fc00);
	Xil_Out32(0x61000000 + 0x11c,0x00f76400);
	Xil_Out32(0x61000000 + 0x120,0x10);
	delay_us(1);
	//Xil_Out32(0x61000000 + 0x11c,0x00f8fc00);
	Xil_Out32(0x61000000 + 0x11c,0x00f86400);
	Xil_Out32(0x61000000 + 0x120,0x10);
	delay_us(1);
	//Xil_Out32(0x61000000 + 0x11c,0x00f9fc00);
	Xil_Out32(0x61000000 + 0x11c,0x00f96400);
	Xil_Out32(0x61000000 + 0x120,0x10);
	delay_us(1);
	//Xil_Out32(0x61000000 + 0x11c,0x00fafc00);
	Xil_Out32(0x61000000 + 0x11c,0x00fa6400);
	Xil_Out32(0x61000000 + 0x120,0x10);
	delay_us(1);
	//Xil_Out32(0x61000000 + 0x11c,0x00fbfc00);
	Xil_Out32(0x61000000 + 0x11c,0x00fb6400);
	Xil_Out32(0x61000000 + 0x120,0x10);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x11c,0x00180500);
	Xil_Out32(0x61000000 + 0x120,0x10);
	delay_us(1);

	Xil_Out32(0x61000000 + 0x11c,0x02320100);
	Xil_Out32(0x61000000 + 0x120,0x10);
	delay_us(1);

}

void ad9520_tmp_config()
{
	Xil_Out32(0x61000000 + 0x124,0x00107c00);
	Xil_Out32(0x61000000 + 0x120,0x100);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x124,0x00130400);
	Xil_Out32(0x61000000 + 0x120,0x100);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x124,0x00140700);
	Xil_Out32(0x61000000 + 0x120,0x100);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x124,0x00160400);
	Xil_Out32(0x61000000 + 0x120,0x100);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x124,0x01e10200);
	Xil_Out32(0x61000000 + 0x120,0x100);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x124,0x001c0200);
	Xil_Out32(0x61000000 + 0x120,0x100);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x124,0x01e00000);
	Xil_Out32(0x61000000 + 0x120,0x100);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x124,0x00180400);
	Xil_Out32(0x61000000 + 0x120,0x100);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x124,0x02320100);
	Xil_Out32(0x61000000 + 0x120,0x100);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x124,0x01902200);
	Xil_Out32(0x61000000 + 0x120,0x100);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x124,0x01932200);
	Xil_Out32(0x61000000 + 0x120,0x100);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x124,0x01962200);
	Xil_Out32(0x61000000 + 0x120,0x100);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x124,0x01992200);
	Xil_Out32(0x61000000 + 0x120,0x100);
	delay_us(1);
	//Xil_Out32(0x61000000 + 0x124,0x00f0fc00);
	Xil_Out32(0x61000000 + 0x124,0x00f06400);
	Xil_Out32(0x61000000 + 0x120,0x100);
	delay_us(1);
	//Xil_Out32(0x61000000 + 0x124,0x00f1fc00);
	Xil_Out32(0x61000000 + 0x124,0x00f16400);
	Xil_Out32(0x61000000 + 0x120,0x100);
	delay_us(1);
	//Xil_Out32(0x61000000 + 0x124,0x00f2fc00);
	Xil_Out32(0x61000000 + 0x124,0x00f26400);
	Xil_Out32(0x61000000 + 0x120,0x100);
	delay_us(1);
	//Xil_Out32(0x61000000 + 0x124,0x00f3fc00);
	Xil_Out32(0x61000000 + 0x124,0x00f36400);
	Xil_Out32(0x61000000 + 0x120,0x100);
	delay_us(1);
	//Xil_Out32(0x61000000 + 0x124,0x00f4fc00);
	Xil_Out32(0x61000000 + 0x124,0x00f46400);
	Xil_Out32(0x61000000 + 0x120,0x100);
	delay_us(1);
	//Xil_Out32(0x61000000 + 0x124,0x00f5fc00);
	Xil_Out32(0x61000000 + 0x124,0x00f56400);
	Xil_Out32(0x61000000 + 0x120,0x100);
	delay_us(1);
	//Xil_Out32(0x61000000 + 0x124,0x00f6fc00);
	Xil_Out32(0x61000000 + 0x124,0x00f66400);
	Xil_Out32(0x61000000 + 0x120,0x100);
	delay_us(1);
	//Xil_Out32(0x61000000 + 0x124,0x00f7fc00);
	Xil_Out32(0x61000000 + 0x124,0x00f76400);
	Xil_Out32(0x61000000 + 0x120,0x100);
	delay_us(1);
	//Xil_Out32(0x61000000 + 0x124,0x00f8fc00);
	Xil_Out32(0x61000000 + 0x124,0x00f86400);
	Xil_Out32(0x61000000 + 0x120,0x100);
	delay_us(1);
	//Xil_Out32(0x61000000 + 0x124,0x00f9fc00);
	Xil_Out32(0x61000000 + 0x124,0x00f96400);
	Xil_Out32(0x61000000 + 0x120,0x100);
	delay_us(1);
	//Xil_Out32(0x61000000 + 0x124,0x00fafc00);
	Xil_Out32(0x61000000 + 0x124,0x00fa6400);
	Xil_Out32(0x61000000 + 0x120,0x100);
	delay_us(1);
	//Xil_Out32(0x61000000 + 0x124,0x00fbfc00);
	Xil_Out32(0x61000000 + 0x124,0x00fb6400);
	Xil_Out32(0x61000000 + 0x120,0x100);
	delay_us(1);
	Xil_Out32(0x61000000 + 0x124,0x00180500);
	Xil_Out32(0x61000000 + 0x120,0x100);
	delay_us(1);

	Xil_Out32(0x61000000 + 0x124,0x02320100);
	Xil_Out32(0x61000000 + 0x120,0x100);
	delay_us(1);

}

int main()
{
    init_platform();

    print("Hello World\n\r");

    //while(1)
    {
    	Xil_Out32(0x61000000 + 0x120,0x100);
    	delay_us(1);
    }

    ad9520_config();
    ad9518_config();
    ad9520_tmp_config();


    cleanup_platform();
    return 0;
}
#endif
